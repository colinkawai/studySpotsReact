{"ast":null,"code":"var _jsxFileName = \"/Users/colinkawai/mapreacdt/src/components/index.js\";\nimport React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport ReactDOM from \"react-dom\";\nimport { camelize } from \"../lib/String.js\";\nimport { makeCancelable } from \"../lib/cancelablePromise.js\";\nimport \"../App.css\";\nconst mapStyles = {\n  container: {\n    position: \"absolute\",\n    width: \"100%\",\n    height: \"100%\"\n  },\n  map: {\n    position: \"absolute\",\n    left: 0,\n    right: 0,\n    bottom: 0,\n    top: 0\n  }\n};\nconst evtNames = [\"ready\", \"click\", \"dragend\", \"recenter\", \"bounds_changed\", \"center_changed\", \"dblclick\", \"dragstart\", \"heading_change\", \"idle\", \"maptypeid_changed\", \"mousemove\", \"mouseout\", \"mouseover\", \"projection_changed\", \"resize\", \"rightclick\", \"tilesloaded\", \"tilt_changed\", \"zoom_changed\"];\nexport { wrapper as GoogleApiWrapper } from \"./GoogleApiComponent\";\nexport { Marker } from \"./Marker\";\nexport { InfoWindow } from \"./InfoWindow\";\nexport class Map extends React.Component {\n  constructor(props) {\n    super(props);\n\n    if (!props.hasOwnProperty(\"google\")) {\n      throw new Error(\"You must include a `google` prop\");\n    }\n\n    this.listeners = {};\n    this.state = {\n      currentLocation: {\n        lat: this.props.initialCenter.lat,\n        lng: this.props.initialCenter.lng\n      }\n    };\n    this.mapRef = React.createRef();\n    this.handleChange = this.handleChange.bind(this);\n  }\n\n  handleChange() {\n    const returnLat = this.state.currentLocation.lat;\n    const returnLng = this.state.currentLocation.lng;\n    this.props.onLocationChange(returnLat, returnLng);\n  }\n\n  componentDidMount() {\n    if (this.props.centerAroundCurrentLocation) {\n      if (navigator && navigator.geolocation) {\n        this.geoPromise = makeCancelable(new Promise((resolve, reject) => {\n          navigator.geolocation.getCurrentPosition(resolve, reject);\n        }));\n        this.geoPromise.promise.then(pos => {\n          const coords = pos.coords;\n          this.setState({\n            currentLocation: {\n              lat: coords.latitude,\n              lng: coords.longitude\n            }\n          });\n        }).catch(e => e);\n      }\n    }\n\n    this.loadMap();\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (prevProps.google !== this.props.google) {\n      this.loadMap();\n    }\n\n    if (this.props.visible !== prevProps.visible) {\n      this.restyleMap();\n    }\n\n    if (this.props.zoom !== prevProps.zoom) {\n      this.map.setZoom(this.props.zoom);\n    }\n\n    if (this.props.center !== prevProps.center) {\n      this.setState({\n        currentLocation: this.props.center\n      });\n    }\n\n    if (prevState.currentLocation !== this.state.currentLocation) {\n      this.recenterMap();\n      this.handleChange();\n    }\n\n    if (this.props.bounds && this.props.bounds !== prevProps.bounds) {\n      this.map.fitBounds(this.props.bounds);\n    }\n  }\n\n  componentWillUnmount() {\n    const {\n      google\n    } = this.props;\n\n    if (this.geoPromise) {\n      this.geoPromise.cancel();\n    }\n\n    Object.keys(this.listeners).forEach(e => {\n      google.maps.event.removeListener(this.listeners[e]);\n    });\n  }\n\n  loadMap() {\n    if (this.props && this.props.google) {\n      const {\n        google\n      } = this.props;\n      const maps = google.maps;\n      const mapRef = this.mapRef.current;\n      const node = ReactDOM.findDOMNode(mapRef);\n      const curr = this.state.currentLocation;\n      const center = new maps.LatLng(curr.lat, curr.lng);\n      const mapTypeIds = this.props.google.maps.MapTypeId || {};\n      const mapTypeFromProps = String(this.props.mapType).toUpperCase();\n      const mapConfig = Object.assign({}, {\n        mapTypeId: mapTypeIds[mapTypeFromProps],\n        center: center,\n        zoom: this.props.zoom,\n        maxZoom: this.props.maxZoom,\n        minZoom: this.props.minZoom,\n        clickableIcons: !!this.props.clickableIcons,\n        disableDefaultUI: this.props.disableDefaultUI,\n        zoomControl: this.props.zoomControl,\n        zoomControlOptions: this.props.zoomControlOptions,\n        mapTypeControl: this.props.mapTypeControl,\n        mapTypeControlOptions: this.props.mapTypeControlOptions,\n        scaleControl: this.props.scaleControl,\n        streetViewControl: this.props.streetViewControl,\n        streetViewControlOptions: this.props.streetViewControlOptions,\n        panControl: this.props.panControl,\n        rotateControl: this.props.rotateControl,\n        fullscreenControl: this.props.fullscreenControl,\n        scrollwheel: this.props.scrollwheel,\n        draggable: this.props.draggable,\n        draggableCursor: this.props.draggableCursor,\n        keyboardShortcuts: this.props.keyboardShortcuts,\n        disableDoubleClickZoom: this.props.disableDoubleClickZoom,\n        noClear: this.props.noClear,\n        styles: this.props.styles,\n        gestureHandling: this.props.gestureHandling\n      });\n      Object.keys(mapConfig).forEach(key => {\n        // Allow to configure mapConfig with 'false'\n        if (mapConfig[key] === null) {\n          delete mapConfig[key];\n        }\n      });\n      this.map = new maps.Map(node, mapConfig);\n      evtNames.forEach(e => {\n        this.listeners[e] = this.map.addListener(e, this.handleEvent(e));\n      });\n      maps.event.trigger(this.map, \"ready\");\n      this.forceUpdate();\n    }\n  }\n\n  handleEvent(evtName) {\n    let timeout;\n    const handlerName = `on${camelize(evtName)}`;\n    return e => {\n      if (timeout) {\n        clearTimeout(timeout);\n        timeout = null;\n      }\n\n      timeout = setTimeout(() => {\n        if (this.props[handlerName]) {\n          this.props[handlerName](this.props, this.map, e);\n        }\n      }, 0);\n    };\n  }\n\n  recenterMap() {\n    const map = this.map;\n    const {\n      google\n    } = this.props;\n    if (!google) return;\n    const maps = google.maps;\n\n    if (map) {\n      let center = this.state.currentLocation;\n\n      if (!(center instanceof google.maps.LatLng)) {\n        center = new google.maps.LatLng(center.lat, center.lng);\n      } // map.panTo(center)\n\n\n      map.setCenter(center);\n      maps.event.trigger(map, \"recenter\");\n    }\n  }\n\n  restyleMap() {\n    if (this.map) {\n      const {\n        google\n      } = this.props;\n      google.maps.event.trigger(this.map, \"resize\");\n    }\n  }\n\n  renderChildren() {\n    const {\n      children\n    } = this.props;\n    if (!children) return;\n    return React.Children.map(children, c => {\n      if (!c) return;\n      return React.cloneElement(c, {\n        map: this.map,\n        google: this.props.google,\n        mapCenter: this.state.currentLocation\n      });\n    });\n  }\n\n  render() {\n    const style = Object.assign({}, mapStyles.map, this.props.style, {\n      display: this.props.visible ? \"inherit\" : \"none\"\n    });\n    const currentLocation = this.state.currentLocation;\n    const containerStyles = Object.assign({}, mapStyles.container, this.props.containerStyle);\n    return React.createElement(\"div\", {\n      className: \"outerMapDiv\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 268\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      style: containerStyles,\n      className: \"someClass\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 269\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      style: {\n        height: \"100%\",\n        width: \"100%\"\n      },\n      ref: this.mapRef,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 270\n      },\n      __self: this\n    }, \"Loading map...\"), this.renderChildren()));\n  }\n\n}\nMap.propTypes = {\n  google: PropTypes.object,\n  zoom: PropTypes.number,\n  centerAroundCurrentLocation: PropTypes.bool,\n  center: PropTypes.object,\n  initialCenter: PropTypes.object,\n  className: PropTypes.string,\n  style: PropTypes.object,\n  containerStyle: PropTypes.object,\n  visible: PropTypes.bool,\n  mapType: PropTypes.string,\n  maxZoom: PropTypes.number,\n  minZoom: PropTypes.number,\n  clickableIcons: PropTypes.bool,\n  disableDefaultUI: PropTypes.bool,\n  zoomControl: PropTypes.bool,\n  zoomControlOptions: PropTypes.object,\n  mapTypeControl: PropTypes.bool,\n  mapTypeControlOptions: PropTypes.bool,\n  scaleControl: PropTypes.bool,\n  streetViewControl: PropTypes.bool,\n  streetViewControlOptions: PropTypes.object,\n  panControl: PropTypes.bool,\n  rotateControl: PropTypes.bool,\n  fullscreenControl: PropTypes.bool,\n  scrollwheel: PropTypes.bool,\n  draggable: PropTypes.bool,\n  draggableCursor: PropTypes.string,\n  keyboardShortcuts: PropTypes.bool,\n  disableDoubleClickZoom: PropTypes.bool,\n  noClear: PropTypes.bool,\n  styles: PropTypes.array,\n  gestureHandling: PropTypes.string,\n  bounds: PropTypes.object\n};\nevtNames.forEach(e => Map.propTypes[camelize(e)] = PropTypes.func);\nMap.defaultProps = {\n  zoom: 14,\n  initialCenter: {\n    lat: 37.774929,\n    lng: -122.419416\n  },\n  center: {},\n  centerAroundCurrentLocation: false,\n  style: {},\n  containerStyle: {},\n  visible: true\n};\nexport default Map;","map":{"version":3,"sources":["/Users/colinkawai/mapreacdt/src/components/index.js"],"names":["React","Component","PropTypes","ReactDOM","camelize","makeCancelable","mapStyles","container","position","width","height","map","left","right","bottom","top","evtNames","wrapper","GoogleApiWrapper","Marker","InfoWindow","Map","constructor","props","hasOwnProperty","Error","listeners","state","currentLocation","lat","initialCenter","lng","mapRef","createRef","handleChange","bind","returnLat","returnLng","onLocationChange","componentDidMount","centerAroundCurrentLocation","navigator","geolocation","geoPromise","Promise","resolve","reject","getCurrentPosition","promise","then","pos","coords","setState","latitude","longitude","catch","e","loadMap","componentDidUpdate","prevProps","prevState","google","visible","restyleMap","zoom","setZoom","center","recenterMap","bounds","fitBounds","componentWillUnmount","cancel","Object","keys","forEach","maps","event","removeListener","current","node","findDOMNode","curr","LatLng","mapTypeIds","MapTypeId","mapTypeFromProps","String","mapType","toUpperCase","mapConfig","assign","mapTypeId","maxZoom","minZoom","clickableIcons","disableDefaultUI","zoomControl","zoomControlOptions","mapTypeControl","mapTypeControlOptions","scaleControl","streetViewControl","streetViewControlOptions","panControl","rotateControl","fullscreenControl","scrollwheel","draggable","draggableCursor","keyboardShortcuts","disableDoubleClickZoom","noClear","styles","gestureHandling","key","addListener","handleEvent","trigger","forceUpdate","evtName","timeout","handlerName","clearTimeout","setTimeout","setCenter","renderChildren","children","Children","c","cloneElement","mapCenter","render","style","display","containerStyles","containerStyle","propTypes","object","number","bool","className","string","array","func","defaultProps"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport ReactDOM from \"react-dom\";\nimport { camelize } from \"../lib/String.js\";\nimport { makeCancelable } from \"../lib/cancelablePromise.js\";\nimport \"../App.css\";\n\nconst mapStyles = {\n  container: {\n    position: \"absolute\",\n    width: \"100%\",\n    height: \"100%\"\n  },\n  map: {\n    position: \"absolute\",\n    left: 0,\n    right: 0,\n    bottom: 0,\n    top: 0\n  }\n};\n\nconst evtNames = [\n  \"ready\",\n  \"click\",\n  \"dragend\",\n  \"recenter\",\n  \"bounds_changed\",\n  \"center_changed\",\n  \"dblclick\",\n  \"dragstart\",\n  \"heading_change\",\n  \"idle\",\n  \"maptypeid_changed\",\n  \"mousemove\",\n  \"mouseout\",\n  \"mouseover\",\n  \"projection_changed\",\n  \"resize\",\n  \"rightclick\",\n  \"tilesloaded\",\n  \"tilt_changed\",\n  \"zoom_changed\"\n];\n\nexport { wrapper as GoogleApiWrapper } from \"./GoogleApiComponent\";\nexport { Marker } from \"./Marker\";\nexport { InfoWindow } from \"./InfoWindow\";\n\nexport class Map extends React.Component {\n  constructor(props) {\n    super(props);\n\n    if (!props.hasOwnProperty(\"google\")) {\n      throw new Error(\"You must include a `google` prop\");\n    }\n\n    this.listeners = {};\n    this.state = {\n      currentLocation: {\n        lat: this.props.initialCenter.lat,\n        lng: this.props.initialCenter.lng\n      }\n    };\n\n    this.mapRef = React.createRef();\n    this.handleChange = this.handleChange.bind(this);\n  }\n  handleChange() {\n    const returnLat = this.state.currentLocation.lat;\n    const returnLng = this.state.currentLocation.lng;\n\n    this.props.onLocationChange(returnLat, returnLng);\n  }\n\n  componentDidMount() {\n    if (this.props.centerAroundCurrentLocation) {\n      if (navigator && navigator.geolocation) {\n        this.geoPromise = makeCancelable(\n          new Promise((resolve, reject) => {\n            navigator.geolocation.getCurrentPosition(resolve, reject);\n          })\n        );\n\n        this.geoPromise.promise\n          .then(pos => {\n            const coords = pos.coords;\n            this.setState({\n              currentLocation: {\n                lat: coords.latitude,\n                lng: coords.longitude\n              }\n            });\n          })\n          .catch(e => e);\n      }\n    }\n\n    this.loadMap();\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (prevProps.google !== this.props.google) {\n      this.loadMap();\n    }\n    if (this.props.visible !== prevProps.visible) {\n      this.restyleMap();\n    }\n    if (this.props.zoom !== prevProps.zoom) {\n      this.map.setZoom(this.props.zoom);\n    }\n    if (this.props.center !== prevProps.center) {\n      this.setState({\n        currentLocation: this.props.center\n      });\n    }\n    if (prevState.currentLocation !== this.state.currentLocation) {\n      this.recenterMap();\n      this.handleChange();\n    }\n    if (this.props.bounds && this.props.bounds !== prevProps.bounds) {\n      this.map.fitBounds(this.props.bounds);\n    }\n  }\n\n  componentWillUnmount() {\n    const { google } = this.props;\n    if (this.geoPromise) {\n      this.geoPromise.cancel();\n    }\n    Object.keys(this.listeners).forEach(e => {\n      google.maps.event.removeListener(this.listeners[e]);\n    });\n  }\n\n  loadMap() {\n    if (this.props && this.props.google) {\n      const { google } = this.props;\n      const maps = google.maps;\n\n      const mapRef = this.mapRef.current;\n      const node = ReactDOM.findDOMNode(mapRef);\n      const curr = this.state.currentLocation;\n      const center = new maps.LatLng(curr.lat, curr.lng);\n\n      const mapTypeIds = this.props.google.maps.MapTypeId || {};\n      const mapTypeFromProps = String(this.props.mapType).toUpperCase();\n\n      const mapConfig = Object.assign(\n        {},\n        {\n          mapTypeId: mapTypeIds[mapTypeFromProps],\n          center: center,\n          zoom: this.props.zoom,\n          maxZoom: this.props.maxZoom,\n          minZoom: this.props.minZoom,\n          clickableIcons: !!this.props.clickableIcons,\n          disableDefaultUI: this.props.disableDefaultUI,\n          zoomControl: this.props.zoomControl,\n          zoomControlOptions: this.props.zoomControlOptions,\n          mapTypeControl: this.props.mapTypeControl,\n          mapTypeControlOptions: this.props.mapTypeControlOptions,\n          scaleControl: this.props.scaleControl,\n          streetViewControl: this.props.streetViewControl,\n          streetViewControlOptions: this.props.streetViewControlOptions,\n          panControl: this.props.panControl,\n          rotateControl: this.props.rotateControl,\n          fullscreenControl: this.props.fullscreenControl,\n          scrollwheel: this.props.scrollwheel,\n          draggable: this.props.draggable,\n          draggableCursor: this.props.draggableCursor,\n          keyboardShortcuts: this.props.keyboardShortcuts,\n          disableDoubleClickZoom: this.props.disableDoubleClickZoom,\n          noClear: this.props.noClear,\n          styles: this.props.styles,\n          gestureHandling: this.props.gestureHandling\n        }\n      );\n\n      Object.keys(mapConfig).forEach(key => {\n        // Allow to configure mapConfig with 'false'\n        if (mapConfig[key] === null) {\n          delete mapConfig[key];\n        }\n      });\n\n      this.map = new maps.Map(node, mapConfig);\n\n      evtNames.forEach(e => {\n        this.listeners[e] = this.map.addListener(e, this.handleEvent(e));\n      });\n      maps.event.trigger(this.map, \"ready\");\n      this.forceUpdate();\n    }\n  }\n\n  handleEvent(evtName) {\n    let timeout;\n    const handlerName = `on${camelize(evtName)}`;\n\n    return e => {\n      if (timeout) {\n        clearTimeout(timeout);\n        timeout = null;\n      }\n      timeout = setTimeout(() => {\n        if (this.props[handlerName]) {\n          this.props[handlerName](this.props, this.map, e);\n        }\n      }, 0);\n    };\n  }\n\n  recenterMap() {\n    const map = this.map;\n\n    const { google } = this.props;\n\n    if (!google) return;\n    const maps = google.maps;\n\n    if (map) {\n      let center = this.state.currentLocation;\n\n      if (!(center instanceof google.maps.LatLng)) {\n        center = new google.maps.LatLng(center.lat, center.lng);\n      }\n      // map.panTo(center)\n      map.setCenter(center);\n      maps.event.trigger(map, \"recenter\");\n    }\n  }\n\n  restyleMap() {\n    if (this.map) {\n      const { google } = this.props;\n      google.maps.event.trigger(this.map, \"resize\");\n    }\n  }\n\n  renderChildren() {\n    const { children } = this.props;\n\n    if (!children) return;\n\n    return React.Children.map(children, c => {\n      if (!c) return;\n      return React.cloneElement(c, {\n        map: this.map,\n        google: this.props.google,\n        mapCenter: this.state.currentLocation\n      });\n    });\n  }\n\n  render() {\n    const style = Object.assign({}, mapStyles.map, this.props.style, {\n      display: this.props.visible ? \"inherit\" : \"none\"\n    });\n    const currentLocation = this.state.currentLocation;\n    const containerStyles = Object.assign(\n      {},\n      mapStyles.container,\n      this.props.containerStyle\n    );\n\n    return (\n      <div className={\"outerMapDiv\"}>\n        <div style={containerStyles} className={\"someClass\"}>\n          <div style={{ height: \"100%\", width: \"100%\" }} ref={this.mapRef}>\n            Loading map...\n          </div>\n\n          {this.renderChildren()}\n        </div>\n      </div>\n    );\n  }\n}\n\nMap.propTypes = {\n  google: PropTypes.object,\n  zoom: PropTypes.number,\n  centerAroundCurrentLocation: PropTypes.bool,\n  center: PropTypes.object,\n  initialCenter: PropTypes.object,\n  className: PropTypes.string,\n  style: PropTypes.object,\n  containerStyle: PropTypes.object,\n  visible: PropTypes.bool,\n  mapType: PropTypes.string,\n  maxZoom: PropTypes.number,\n  minZoom: PropTypes.number,\n  clickableIcons: PropTypes.bool,\n  disableDefaultUI: PropTypes.bool,\n  zoomControl: PropTypes.bool,\n  zoomControlOptions: PropTypes.object,\n  mapTypeControl: PropTypes.bool,\n  mapTypeControlOptions: PropTypes.bool,\n  scaleControl: PropTypes.bool,\n  streetViewControl: PropTypes.bool,\n  streetViewControlOptions: PropTypes.object,\n  panControl: PropTypes.bool,\n  rotateControl: PropTypes.bool,\n  fullscreenControl: PropTypes.bool,\n  scrollwheel: PropTypes.bool,\n  draggable: PropTypes.bool,\n  draggableCursor: PropTypes.string,\n  keyboardShortcuts: PropTypes.bool,\n  disableDoubleClickZoom: PropTypes.bool,\n  noClear: PropTypes.bool,\n  styles: PropTypes.array,\n  gestureHandling: PropTypes.string,\n  bounds: PropTypes.object\n};\n\nevtNames.forEach(e => (Map.propTypes[camelize(e)] = PropTypes.func));\n\nMap.defaultProps = {\n  zoom: 14,\n  initialCenter: {\n    lat: 37.774929,\n    lng: -122.419416\n  },\n  center: {},\n  centerAroundCurrentLocation: false,\n  style: {},\n  containerStyle: {},\n  visible: true\n};\n\nexport default Map;\n"]},"metadata":{},"sourceType":"module"}