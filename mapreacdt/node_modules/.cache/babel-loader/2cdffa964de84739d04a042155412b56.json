{"ast":null,"code":"var _jsxFileName = \"/Users/colinkawai/mapreacdt/src/components/index.js\";\nimport React from \"react\";\nimport PropTypes from \"prop-types\";\nimport ReactDOM from \"react-dom\";\nimport { camelize } from \"../lib/String.js\";\nimport { makeCancelable } from \"../lib/cancelablePromise.js\";\nconst mapStyles = {\n  container: {\n    position: \"absolute\",\n    width: \"100%\",\n    height: \"100%\"\n  },\n  map: {\n    position: \"absolute\",\n    left: 0,\n    right: 0,\n    bottom: 0,\n    top: 0\n  }\n};\nconst evtNames = [\"ready\", \"click\", \"dragend\", \"recenter\", \"bounds_changed\", \"center_changed\", \"dblclick\", \"dragstart\", \"heading_change\", \"idle\", \"maptypeid_changed\", \"mousemove\", \"mouseout\", \"mouseover\", \"projection_changed\", \"resize\", \"rightclick\", \"tilesloaded\", \"tilt_changed\", \"zoom_changed\"];\nexport { wrapper as GoogleApiWrapper } from \"./GoogleApiComponent\";\nexport { Marker } from \"./Marker\";\nexport { InfoWindow } from \"./InfoWindow\";\nexport class Map extends React.Component {\n  constructor(props) {\n    super(props);\n\n    if (!props.hasOwnProperty(\"google\")) {\n      throw new Error(\"You must include a `google` prop\");\n    }\n\n    this.listeners = {};\n    this.state = {\n      currentLocation: {\n        lat: this.props.initialCenter.lat,\n        lng: this.props.initialCenter.lng\n      }\n    };\n    this.mapRef = React.createRef();\n    this.handleChange = this.handleChange.bind(this);\n  }\n\n  handleChange(e) {\n    const returnlat = e.target.value.lat;\n    const returnlng = e.target.value.lng;\n    this.props.onLocationChange(returnlat, returnlng);\n  }\n\n  componentDidMount() {\n    if (this.props.centerAroundCurrentLocation) {\n      if (navigator && navigator.geolocation) {\n        this.geoPromise = makeCancelable(new Promise((resolve, reject) => {\n          navigator.geolocation.getCurrentPosition(resolve, reject);\n        }));\n        this.geoPromise.promise.then(pos => {\n          const coords = pos.coords;\n          this.setState({\n            currentLocation: {\n              lat: coords.latitude,\n              lng: coords.longitude\n            }\n          });\n        }).catch(e => e);\n      }\n    }\n\n    this.loadMap();\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (prevProps.google !== this.props.google) {\n      this.loadMap();\n    }\n\n    if (this.props.visible !== prevProps.visible) {\n      this.restyleMap();\n    }\n\n    if (this.props.zoom !== prevProps.zoom) {\n      this.map.setZoom(this.props.zoom);\n    }\n\n    if (this.props.center !== prevProps.center) {\n      this.setState({\n        currentLocation: this.props.center\n      });\n    }\n\n    if (prevState.currentLocation !== this.state.currentLocation) {\n      this.recenterMap();\n    }\n\n    if (this.props.bounds && this.props.bounds !== prevProps.bounds) {\n      this.map.fitBounds(this.props.bounds);\n    }\n  }\n\n  componentWillUnmount() {\n    const {\n      google\n    } = this.props;\n\n    if (this.geoPromise) {\n      this.geoPromise.cancel();\n    }\n\n    Object.keys(this.listeners).forEach(e => {\n      google.maps.event.removeListener(this.listeners[e]);\n    });\n  }\n\n  loadMap() {\n    if (this.props && this.props.google) {\n      const {\n        google\n      } = this.props;\n      const maps = google.maps;\n      const mapRef = this.mapRef.current;\n      const node = ReactDOM.findDOMNode(mapRef);\n      const curr = this.state.currentLocation;\n      const center = new maps.LatLng(curr.lat, curr.lng);\n      const mapTypeIds = this.props.google.maps.MapTypeId || {};\n      const mapTypeFromProps = String(this.props.mapType).toUpperCase();\n      const mapConfig = Object.assign({}, {\n        mapTypeId: mapTypeIds[mapTypeFromProps],\n        center: center,\n        zoom: this.props.zoom,\n        maxZoom: this.props.maxZoom,\n        minZoom: this.props.minZoom,\n        clickableIcons: !!this.props.clickableIcons,\n        disableDefaultUI: this.props.disableDefaultUI,\n        zoomControl: this.props.zoomControl,\n        zoomControlOptions: this.props.zoomControlOptions,\n        mapTypeControl: this.props.mapTypeControl,\n        mapTypeControlOptions: this.props.mapTypeControlOptions,\n        scaleControl: this.props.scaleControl,\n        streetViewControl: this.props.streetViewControl,\n        streetViewControlOptions: this.props.streetViewControlOptions,\n        panControl: this.props.panControl,\n        rotateControl: this.props.rotateControl,\n        fullscreenControl: this.props.fullscreenControl,\n        scrollwheel: this.props.scrollwheel,\n        draggable: this.props.draggable,\n        draggableCursor: this.props.draggableCursor,\n        keyboardShortcuts: this.props.keyboardShortcuts,\n        disableDoubleClickZoom: this.props.disableDoubleClickZoom,\n        noClear: this.props.noClear,\n        styles: this.props.styles,\n        gestureHandling: this.props.gestureHandling\n      });\n      Object.keys(mapConfig).forEach(key => {\n        // Allow to configure mapConfig with 'false'\n        if (mapConfig[key] === null) {\n          delete mapConfig[key];\n        }\n      });\n      this.map = new maps.Map(node, mapConfig);\n      evtNames.forEach(e => {\n        this.listeners[e] = this.map.addListener(e, this.handleEvent(e));\n      });\n      maps.event.trigger(this.map, \"ready\");\n      this.forceUpdate();\n    }\n  }\n\n  handleEvent(evtName) {\n    let timeout;\n    const handlerName = `on${camelize(evtName)}`;\n    return e => {\n      if (timeout) {\n        clearTimeout(timeout);\n        timeout = null;\n      }\n\n      timeout = setTimeout(() => {\n        if (this.props[handlerName]) {\n          this.props[handlerName](this.props, this.map, e);\n        }\n      }, 0);\n    };\n  }\n\n  recenterMap() {\n    const map = this.map;\n    const {\n      google\n    } = this.props;\n    if (!google) return;\n    const maps = google.maps;\n\n    if (map) {\n      let center = this.state.currentLocation;\n\n      if (!(center instanceof google.maps.LatLng)) {\n        center = new google.maps.LatLng(center.lat, center.lng);\n      } // map.panTo(center)\n\n\n      map.setCenter(center);\n      maps.event.trigger(map, \"recenter\");\n    }\n  }\n\n  restyleMap() {\n    if (this.map) {\n      const {\n        google\n      } = this.props;\n      google.maps.event.trigger(this.map, \"resize\");\n    }\n  }\n\n  renderChildren() {\n    const {\n      children\n    } = this.props;\n    if (!children) return;\n    return React.Children.map(children, c => {\n      if (!c) return;\n      return React.cloneElement(c, {\n        map: this.map,\n        google: this.props.google,\n        mapCenter: this.state.currentLocation\n      });\n    });\n  }\n\n  render() {\n    const style = Object.assign({}, mapStyles.map, this.props.style, {\n      display: this.props.visible ? \"inherit\" : \"none\"\n    });\n    const currentLocation = this.state.currentLocation;\n    const containerStyles = Object.assign({}, mapStyles.container, this.props.containerStyle);\n    return React.createElement(\"div\", {\n      style: containerStyles,\n      className: this.props.className,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 263\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      style: style,\n      ref: this.mapRef,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 264\n      },\n      __self: this\n    }, \"onChange=\", this.handleChange, \"value=\", currentLocation, \"Loading map...\"), this.renderChildren());\n  }\n\n}\nMap.propTypes = {\n  google: PropTypes.object,\n  zoom: PropTypes.number,\n  centerAroundCurrentLocation: PropTypes.bool,\n  center: PropTypes.object,\n  initialCenter: PropTypes.object,\n  className: PropTypes.string,\n  style: PropTypes.object,\n  containerStyle: PropTypes.object,\n  visible: PropTypes.bool,\n  mapType: PropTypes.string,\n  maxZoom: PropTypes.number,\n  minZoom: PropTypes.number,\n  clickableIcons: PropTypes.bool,\n  disableDefaultUI: PropTypes.bool,\n  zoomControl: PropTypes.bool,\n  zoomControlOptions: PropTypes.object,\n  mapTypeControl: PropTypes.bool,\n  mapTypeControlOptions: PropTypes.bool,\n  scaleControl: PropTypes.bool,\n  streetViewControl: PropTypes.bool,\n  streetViewControlOptions: PropTypes.object,\n  panControl: PropTypes.bool,\n  rotateControl: PropTypes.bool,\n  fullscreenControl: PropTypes.bool,\n  scrollwheel: PropTypes.bool,\n  draggable: PropTypes.bool,\n  draggableCursor: PropTypes.string,\n  keyboardShortcuts: PropTypes.bool,\n  disableDoubleClickZoom: PropTypes.bool,\n  noClear: PropTypes.bool,\n  styles: PropTypes.array,\n  gestureHandling: PropTypes.string,\n  bounds: PropTypes.object\n};\nevtNames.forEach(e => Map.propTypes[camelize(e)] = PropTypes.func);\nMap.defaultProps = {\n  zoom: 14,\n  initialCenter: {\n    lat: 37.774929,\n    lng: -122.419416\n  },\n  center: {},\n  centerAroundCurrentLocation: false,\n  style: {},\n  containerStyle: {},\n  visible: true\n};\nexport default Map;","map":{"version":3,"sources":["/Users/colinkawai/mapreacdt/src/components/index.js"],"names":["React","PropTypes","ReactDOM","camelize","makeCancelable","mapStyles","container","position","width","height","map","left","right","bottom","top","evtNames","wrapper","GoogleApiWrapper","Marker","InfoWindow","Map","Component","constructor","props","hasOwnProperty","Error","listeners","state","currentLocation","lat","initialCenter","lng","mapRef","createRef","handleChange","bind","e","returnlat","target","value","returnlng","onLocationChange","componentDidMount","centerAroundCurrentLocation","navigator","geolocation","geoPromise","Promise","resolve","reject","getCurrentPosition","promise","then","pos","coords","setState","latitude","longitude","catch","loadMap","componentDidUpdate","prevProps","prevState","google","visible","restyleMap","zoom","setZoom","center","recenterMap","bounds","fitBounds","componentWillUnmount","cancel","Object","keys","forEach","maps","event","removeListener","current","node","findDOMNode","curr","LatLng","mapTypeIds","MapTypeId","mapTypeFromProps","String","mapType","toUpperCase","mapConfig","assign","mapTypeId","maxZoom","minZoom","clickableIcons","disableDefaultUI","zoomControl","zoomControlOptions","mapTypeControl","mapTypeControlOptions","scaleControl","streetViewControl","streetViewControlOptions","panControl","rotateControl","fullscreenControl","scrollwheel","draggable","draggableCursor","keyboardShortcuts","disableDoubleClickZoom","noClear","styles","gestureHandling","key","addListener","handleEvent","trigger","forceUpdate","evtName","timeout","handlerName","clearTimeout","setTimeout","setCenter","renderChildren","children","Children","c","cloneElement","mapCenter","render","style","display","containerStyles","containerStyle","className","propTypes","object","number","bool","string","array","func","defaultProps"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport ReactDOM from \"react-dom\";\nimport { camelize } from \"../lib/String.js\";\nimport { makeCancelable } from \"../lib/cancelablePromise.js\";\n\nconst mapStyles = {\n  container: {\n    position: \"absolute\",\n    width: \"100%\",\n    height: \"100%\"\n  },\n  map: {\n    position: \"absolute\",\n    left: 0,\n    right: 0,\n    bottom: 0,\n    top: 0\n  }\n};\n\nconst evtNames = [\n  \"ready\",\n  \"click\",\n  \"dragend\",\n  \"recenter\",\n  \"bounds_changed\",\n  \"center_changed\",\n  \"dblclick\",\n  \"dragstart\",\n  \"heading_change\",\n  \"idle\",\n  \"maptypeid_changed\",\n  \"mousemove\",\n  \"mouseout\",\n  \"mouseover\",\n  \"projection_changed\",\n  \"resize\",\n  \"rightclick\",\n  \"tilesloaded\",\n  \"tilt_changed\",\n  \"zoom_changed\"\n];\n\nexport { wrapper as GoogleApiWrapper } from \"./GoogleApiComponent\";\nexport { Marker } from \"./Marker\";\nexport { InfoWindow } from \"./InfoWindow\";\n\nexport class Map extends React.Component {\n  constructor(props) {\n    super(props);\n\n    if (!props.hasOwnProperty(\"google\")) {\n      throw new Error(\"You must include a `google` prop\");\n    }\n\n    this.listeners = {};\n    this.state = {\n      currentLocation: {\n        lat: this.props.initialCenter.lat,\n        lng: this.props.initialCenter.lng\n      }\n    };\n\n    this.mapRef = React.createRef();\n    this.handleChange = this.handleChange.bind(this);\n  }\n  handleChange(e) {\n    const returnlat = e.target.value.lat;\n    const returnlng = e.target.value.lng;\n    this.props.onLocationChange(returnlat, returnlng);\n  }\n\n  componentDidMount() {\n    if (this.props.centerAroundCurrentLocation) {\n      if (navigator && navigator.geolocation) {\n        this.geoPromise = makeCancelable(\n          new Promise((resolve, reject) => {\n            navigator.geolocation.getCurrentPosition(resolve, reject);\n          })\n        );\n\n        this.geoPromise.promise\n          .then(pos => {\n            const coords = pos.coords;\n            this.setState({\n              currentLocation: {\n                lat: coords.latitude,\n                lng: coords.longitude\n              }\n            });\n          })\n          .catch(e => e);\n      }\n    }\n    this.loadMap();\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (prevProps.google !== this.props.google) {\n      this.loadMap();\n    }\n    if (this.props.visible !== prevProps.visible) {\n      this.restyleMap();\n    }\n    if (this.props.zoom !== prevProps.zoom) {\n      this.map.setZoom(this.props.zoom);\n    }\n    if (this.props.center !== prevProps.center) {\n      this.setState({\n        currentLocation: this.props.center\n      });\n    }\n    if (prevState.currentLocation !== this.state.currentLocation) {\n      this.recenterMap();\n    }\n    if (this.props.bounds && this.props.bounds !== prevProps.bounds) {\n      this.map.fitBounds(this.props.bounds);\n    }\n  }\n\n  componentWillUnmount() {\n    const { google } = this.props;\n    if (this.geoPromise) {\n      this.geoPromise.cancel();\n    }\n    Object.keys(this.listeners).forEach(e => {\n      google.maps.event.removeListener(this.listeners[e]);\n    });\n  }\n\n  loadMap() {\n    if (this.props && this.props.google) {\n      const { google } = this.props;\n      const maps = google.maps;\n\n      const mapRef = this.mapRef.current;\n      const node = ReactDOM.findDOMNode(mapRef);\n      const curr = this.state.currentLocation;\n      const center = new maps.LatLng(curr.lat, curr.lng);\n\n      const mapTypeIds = this.props.google.maps.MapTypeId || {};\n      const mapTypeFromProps = String(this.props.mapType).toUpperCase();\n\n      const mapConfig = Object.assign(\n        {},\n        {\n          mapTypeId: mapTypeIds[mapTypeFromProps],\n          center: center,\n          zoom: this.props.zoom,\n          maxZoom: this.props.maxZoom,\n          minZoom: this.props.minZoom,\n          clickableIcons: !!this.props.clickableIcons,\n          disableDefaultUI: this.props.disableDefaultUI,\n          zoomControl: this.props.zoomControl,\n          zoomControlOptions: this.props.zoomControlOptions,\n          mapTypeControl: this.props.mapTypeControl,\n          mapTypeControlOptions: this.props.mapTypeControlOptions,\n          scaleControl: this.props.scaleControl,\n          streetViewControl: this.props.streetViewControl,\n          streetViewControlOptions: this.props.streetViewControlOptions,\n          panControl: this.props.panControl,\n          rotateControl: this.props.rotateControl,\n          fullscreenControl: this.props.fullscreenControl,\n          scrollwheel: this.props.scrollwheel,\n          draggable: this.props.draggable,\n          draggableCursor: this.props.draggableCursor,\n          keyboardShortcuts: this.props.keyboardShortcuts,\n          disableDoubleClickZoom: this.props.disableDoubleClickZoom,\n          noClear: this.props.noClear,\n          styles: this.props.styles,\n          gestureHandling: this.props.gestureHandling\n        }\n      );\n\n      Object.keys(mapConfig).forEach(key => {\n        // Allow to configure mapConfig with 'false'\n        if (mapConfig[key] === null) {\n          delete mapConfig[key];\n        }\n      });\n\n      this.map = new maps.Map(node, mapConfig);\n\n      evtNames.forEach(e => {\n        this.listeners[e] = this.map.addListener(e, this.handleEvent(e));\n      });\n      maps.event.trigger(this.map, \"ready\");\n      this.forceUpdate();\n    }\n  }\n\n  handleEvent(evtName) {\n    let timeout;\n    const handlerName = `on${camelize(evtName)}`;\n\n    return e => {\n      if (timeout) {\n        clearTimeout(timeout);\n        timeout = null;\n      }\n      timeout = setTimeout(() => {\n        if (this.props[handlerName]) {\n          this.props[handlerName](this.props, this.map, e);\n        }\n      }, 0);\n    };\n  }\n\n  recenterMap() {\n    const map = this.map;\n\n    const { google } = this.props;\n\n    if (!google) return;\n    const maps = google.maps;\n\n    if (map) {\n      let center = this.state.currentLocation;\n      if (!(center instanceof google.maps.LatLng)) {\n        center = new google.maps.LatLng(center.lat, center.lng);\n      }\n      // map.panTo(center)\n      map.setCenter(center);\n      maps.event.trigger(map, \"recenter\");\n    }\n  }\n\n  restyleMap() {\n    if (this.map) {\n      const { google } = this.props;\n      google.maps.event.trigger(this.map, \"resize\");\n    }\n  }\n\n  renderChildren() {\n    const { children } = this.props;\n\n    if (!children) return;\n\n    return React.Children.map(children, c => {\n      if (!c) return;\n      return React.cloneElement(c, {\n        map: this.map,\n        google: this.props.google,\n        mapCenter: this.state.currentLocation\n      });\n    });\n  }\n\n  render() {\n    const style = Object.assign({}, mapStyles.map, this.props.style, {\n      display: this.props.visible ? \"inherit\" : \"none\"\n    });\n    const currentLocation = this.state.currentLocation;\n    const containerStyles = Object.assign(\n      {},\n      mapStyles.container,\n      this.props.containerStyle\n    );\n\n    return (\n      <div style={containerStyles} className={this.props.className}>\n        <div style={style} ref={this.mapRef}>\n          onChange={this.handleChange}\n          value={currentLocation}\n          Loading map...\n        </div>\n\n        {this.renderChildren()}\n      </div>\n    );\n  }\n}\n\nMap.propTypes = {\n  google: PropTypes.object,\n  zoom: PropTypes.number,\n  centerAroundCurrentLocation: PropTypes.bool,\n  center: PropTypes.object,\n  initialCenter: PropTypes.object,\n  className: PropTypes.string,\n  style: PropTypes.object,\n  containerStyle: PropTypes.object,\n  visible: PropTypes.bool,\n  mapType: PropTypes.string,\n  maxZoom: PropTypes.number,\n  minZoom: PropTypes.number,\n  clickableIcons: PropTypes.bool,\n  disableDefaultUI: PropTypes.bool,\n  zoomControl: PropTypes.bool,\n  zoomControlOptions: PropTypes.object,\n  mapTypeControl: PropTypes.bool,\n  mapTypeControlOptions: PropTypes.bool,\n  scaleControl: PropTypes.bool,\n  streetViewControl: PropTypes.bool,\n  streetViewControlOptions: PropTypes.object,\n  panControl: PropTypes.bool,\n  rotateControl: PropTypes.bool,\n  fullscreenControl: PropTypes.bool,\n  scrollwheel: PropTypes.bool,\n  draggable: PropTypes.bool,\n  draggableCursor: PropTypes.string,\n  keyboardShortcuts: PropTypes.bool,\n  disableDoubleClickZoom: PropTypes.bool,\n  noClear: PropTypes.bool,\n  styles: PropTypes.array,\n  gestureHandling: PropTypes.string,\n  bounds: PropTypes.object\n};\n\nevtNames.forEach(e => (Map.propTypes[camelize(e)] = PropTypes.func));\n\nMap.defaultProps = {\n  zoom: 14,\n  initialCenter: {\n    lat: 37.774929,\n    lng: -122.419416\n  },\n  center: {},\n  centerAroundCurrentLocation: false,\n  style: {},\n  containerStyle: {},\n  visible: true\n};\n\nexport default Map;\n"]},"metadata":{},"sourceType":"module"}